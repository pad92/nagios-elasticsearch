language: python
python:
  - "2.7"
  - "3.8"
  # PyPy versions
  - "pypy"   # currently Python 2.7.13, PyPy 7.1.1
  - "pypy3"  # currently Python 3.6.1,  PyPy 7.1.1-beta0
install:
  - pip install -r requirements.txt
stages:
  - pycodestyle
  - test
  
jobs:
  include:
    - stage: pycodestyle
      python: 2.7
      script:
      - pip install pycodestyle
      - pycodestyle --show-pep8 $(find . -name "*.py") || exit 0
    - stage: pycodestyle
      python: 3.8
      script:
      - pip install pycodestyle
      - pycodestyle --show-pep8 $(find . -name "*.py") || exit 0
    - stage: test
      python:
      - "2.7"
      - "pypy"
      script: python setup.py test
    - stage: test
      python:
      - "3.8"
      - "pypy3"
      script: python setup.py test
